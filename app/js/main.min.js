function start(){start1=performance.now(),loop=window.requestAnimationFrame(start),counter%gameSpeed==0&&game(),counter++}function game(){update(),render()}function update(){bgpos-=speed,-width>=bgpos&&(bgpos=0);for(i in enemies)enemies[i].x-=speed,enemies[i].x<-510&&enemies.splice(i,1);counter%50==0&&enemies.push(new enemy),keys[37]&&!gameIsOver&&(player.x-=5),keys[39]&&!gameIsOver&&(player.x+=5),keys[38]&&!gameIsOver&&(player.y-=5),keys[40]&&!gameIsOver&&(player.y+=5),player.x<0&&(player.x=0),player.y<=25&&(player.y=25),player.x>=width-player.width&&(player.x=width-player.width),player.y>=height-player.height-50&&(player.y=height-player.height-50)}function render(){context.clearRect(0,0,width,height),context.fillRect(0,0,width,25),context.fillRect(player.x,player.y,player.width,player.height),context.save(),context.translate(player.x,player.y),context.rotate(player.hand.rotation*Math.PI/180),context.fillStyle="red",context.globalAlpha=.1,context.fillRect(0,-1,2500,1),context.fillRect(0,1,2500,1),context.globalAlpha=.5,context.fillRect(0,0,2500,1),context.globalAlpha=1,context.fillStyle="cyan",context.fillRect(0,0,50,4),context.fillStyle="black",context.restore(),context.fillRect(0,225,width,50);for(i in enemies){var e=enemies[i];context.fillRect(e.x,e.y,e.width,e.height)}}function initImages(e){requiredImages=e.length;for(i in e){console.log(e[i]);var t=new Image;t.src="/image/"+e[i],images[i]=t,images[i].onload=function(){doneImages++,console.log(doneImages)}}}var canvas=document.getElementById("context");canvas.width=1e3,canvas.height=275,canvas.style.width=canvas.width+"px",canvas.style.height=canvas.height+"px";var context=canvas.getContext("2d"),width=1e3,height=275;window.addEventListener("keydown",function(e){keys[e.keyCode]=!0},!1),window.addEventListener("keyup",function(e){delete keys[e.keyCode]},!1),window.addEventListener("mousemove",function(e){deltaX=event.clientX-10-player.x,deltaY=event.clientY-10-player.y,console.log(deltaY),player.hand.rotation=180/Math.PI*Math.atan2(deltaY,deltaX)},!1);var loop,counter=0,gameIsOver=!1,enemies=[],gameSpeed=1,keys=[],bgpos=0,deltaX,deltaY,speed=5,images=[],requiredImages=0,doneImages=0,player={width:20,height:20,y:100,x:50,hand:{rotation:0}};initImages(["road1.png"]);var enemy=function(){this.x=width+100*Math.random(),this.y=25+50*Math.floor(4*Math.random()),this.width=24,this.height=50,this.isMoving=!1,this.movingTime=20,this.movingSpeed=4,this.health=5,this.isDead=!1,this.maxHealth=5,this.name_id="normal",this.score=4},start1;start();